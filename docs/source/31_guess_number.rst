.. note::

    ã“ã‚“ã«ã¡ã¯ï¼SunFounder Raspberry Pi & Arduino & ESP32 æ„›å¥½è€…ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®Facebookãƒšãƒ¼ã‚¸ã¸ã‚ˆã†ã“ãï¼ã“ã“ã§ã¯ã€Raspberry Piã€Arduinoã€ESP32ã®ä¸–ç•Œã‚’ã•ã‚‰ã«æ·±ãæ¢æ±‚ã—ã€ä»–ã®æ„›å¥½è€…ã¨ä¸€ç·’ã«æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

    **å‚åŠ ã™ã‚‹ç†ç”±**

    - **ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã‚µãƒãƒ¼ãƒˆ**: ã‚¢ãƒ•ã‚¿ãƒ¼ã‚»ãƒ¼ãƒ«ã‚¹ã®å•é¡Œã‚„æŠ€è¡“çš„ãªèª²é¡Œã‚’ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ãƒãƒ¼ãƒ ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦è§£æ±ºã§ãã¾ã™ã€‚
    - **å­¦ã³ã¨å…±æœ‰**: ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®ãƒ’ãƒ³ãƒˆã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’äº¤æ›ã§ãã¾ã™ã€‚
    - **é™å®šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**: æ–°è£½å“ã®ç™ºè¡¨ã‚„å…ˆè¡Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ—©æœŸã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚
    - **ç‰¹åˆ¥å‰²å¼•**: æœ€æ–°ã®è£½å“ã«å¯¾ã™ã‚‹ç‰¹åˆ¥å‰²å¼•ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚
    - **ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚®ãƒ–ã‚¢ã‚¦ã‚§ã‚¤**: ã‚®ãƒ–ã‚¢ã‚¦ã‚§ã‚¤ã‚„ãƒ›ãƒªãƒ‡ãƒ¼ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã§ãã¾ã™ã€‚

    ğŸ‘‰ ä¸€ç·’ã«æ¢æ±‚ã—ã€å‰µé€ ã™ã‚‹æº–å‚™ã¯ã§ãã¾ã—ãŸã‹ï¼Ÿä»Šã™ã[|link_sf_facebook|]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

31. æ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ 
==========================
ä»Šæ—¥ã®ãƒ¬ãƒƒã‚¹ãƒ³ã¸ã‚ˆã†ã“ãï¼ã“ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€IRãƒªãƒ¢ã‚³ãƒ³ã¨LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‚’ä½¿ã£ã¦ã€éš ã•ã‚ŒãŸæ•°å­—ã‚’å½“ã¦ã‚‹ã‚²ãƒ¼ãƒ ã‚’ä½œæˆã—ã€æ¥½ã—ãå­¦ã³ã¾ã—ã‚‡ã†ã€‚

ã€Œæ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ ã€ã¯ã€å‹é”ã¨ä¸€ç·’ã«æ¥½ã—ã‚€ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚²ãƒ¼ãƒ ã§ã™ã€‚0ï½99ã®æ•°å­—ã‚’äº¤äº’ã«å…¥åŠ›ã—ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ­£è§£ã‚’å½“ã¦ã‚‹ã¾ã§ç¯„å›²ãŒç‹­ã¾ã‚Šã¾ã™ã€‚æ­£è§£ã—ãŸãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ç½°ã‚²ãƒ¼ãƒ ã‚’å—ã‘ã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ©ãƒƒã‚­ãƒ¼ãƒŠãƒ³ãƒãƒ¼ãŒ51ã§ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ãŒ50ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€æ¬¡ã®ç¯„å›²ã¯50ï½99ã«ç‹­ã¾ã‚Šã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2ãŒ70ã‚’å…¥åŠ›ã™ã‚‹ã¨ç¯„å›²ãŒ50ï½70ã«ãªã‚Šã¾ã™ã€‚ãã—ã¦ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼3ãŒ51ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒç½°ã‚²ãƒ¼ãƒ ã¨ãªã‚Šã¾ã™ã€‚ã“ã“ã§ã¯ã€IRãƒªãƒ¢ã‚³ãƒ³ã§æ•°å­—ã‚’å…¥åŠ›ã—ã€LCDã«çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

.. raw:: html

    <video muted controls style = "max-width:90%">
        <source src="_static/video/31_guess_number.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§å­¦ã¹ã‚‹ã“ã¨ï¼š

* ã‚²ãƒ¼ãƒ ã®ç§˜å¯†ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ã—ã¦ä½¿ã†ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å­—ã®ç”Ÿæˆæ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚
* èµ¤å¤–ç·šãƒªãƒ¢ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’è¡Œã„ã€æ•°å­—ã‚’æ¨æ¸¬ã—ã¾ã™ã€‚
* æ¨æ¸¬ãŒé«˜ã™ãã‚‹ã‹ä½ã™ãã‚‹ã‹ã€ã¾ãŸã¯æ­£ã—ã„ã‹ã‚’LCDã§å³åº§ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã—ã¾ã™ã€‚
* ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ•ãƒ­ãƒ¼ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã«æ¡ä»¶æ–‡ã¨ãƒ«ãƒ¼ãƒ—æ§‹é€ ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚


å›è·¯ã®æ§‹ç¯‰
--------------------------------
**å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

.. list-table:: 
   :widths: 25 25 25 25
   :header-rows: 0

   * - 1 * Arduino Uno R3
     - 1 * I2C LCD1602
     - 1 * IRå—ä¿¡æ©Ÿ
     - 1 * ãƒªãƒ¢ã‚³ãƒ³
   * - |list_uno_r3| 
     - |list_i2c_lcd1602| 
     - |list_receiver| 
     - |list_remote| 
   * - 1 * USBã‚±ãƒ¼ãƒ–ãƒ«
     - 1 * ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰
     - ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼ãƒ¯ã‚¤ãƒ¤ãƒ¼
     - 
   * - |list_usb_cable| 
     - |list_breadboard| 
     - |list_wire| 
     - 

**ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã®æ§‹ç¯‰æ‰‹é †**

é…ç·šå›³ã«å¾“ã£ã¦å›è·¯ã‚’æ§‹ç¯‰ã™ã‚‹ã‹ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚

.. image:: img/31_guess_circuit.png
    :width: 700
    :align: center

1. èµ¤å¤–ç·šå—ä¿¡æ©Ÿã‚’ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã«å·®ã—è¾¼ã¿ã¾ã™ã€‚èµ¤å¤–ç·šå—ä¿¡æ©Ÿã«ã¯è¡¨ã¨è£ãŒã‚ã‚Šã€çªèµ·ãŒã‚ã‚‹æ–¹ãŒå‰é¢ã§ã™ã€‚å·¦ã‹ã‚‰å³ã¸ã®ãƒ”ãƒ³é †ã¯ã€OUTã€GNDã€VCCã§ã™ã€‚

.. image:: img/31_guess_receiver.png
    :width: 500
    :align: center

2. èµ¤å¤–ç·šå—ä¿¡æ©Ÿã®OUTãƒ”ãƒ³ã‚’Arduino Uno R3ã®ãƒ”ãƒ³2ã«æ¥ç¶šã—ã€GNDã‚’ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®è² æ¥µã«ã€VCCã‚’ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®æ­£æ¥µã«æ¥ç¶šã—ã¾ã™ã€‚

.. image:: img/31_guess_receiver_pins.png
    :width: 500
    :align: center

3. I2C LCD1602ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¥ç¶šã—ã¾ã™ï¼šGNDã‚’ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®è² æ¥µã«ã€VCCã‚’ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®æ­£æ¥µã«ã€SDAã‚’ãƒ”ãƒ³A4ã«ã€SCLã‚’ãƒ”ãƒ³A5ã«æ¥ç¶šã—ã¾ã™ã€‚

.. image:: img/31_guess_i2c_lcd1602.png
    :width: 700
    :align: center

4. æœ€å¾Œã«ã€Arduino Uno R3ã®GNDã¨5Vãƒ”ãƒ³ã‚’ãã‚Œãã‚Œãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®è² æ¥µã¨æ­£æ¥µã«æ¥ç¶šã—ã¾ã™ã€‚

.. image:: img/31_guess_circuit.png
    :width: 700
    :align: center

ã‚³ãƒ¼ãƒ‰ã®ä½œæˆ
------------------
æ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ ã‚’å®Ÿè£…ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ç‚¹ã‚’æ…é‡ã«æ¤œè¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

* **ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å­—**: ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ•°å­—ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
* **ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã©ã®ã‚ˆã†ã«ã—ã¦æ•°å­—ã‚’å…¥åŠ›ã™ã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ï¼ˆä¾‹ï¼šã‚­ãƒ¼ãƒ‘ãƒƒãƒ‰ã€IRãƒªãƒ¢ã‚³ãƒ³ï¼‰ã€‚
* **ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«æ¨æ¸¬ãŒé«˜ã™ãã‚‹ã‹ä½ã™ãã‚‹ã‹ã€ã¾ãŸã¯æ­£ã—ã„ã‹ã‚’ã©ã®ã‚ˆã†ã«ä¼ãˆã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚
* **ã‚²ãƒ¼ãƒ ã®åˆ¶é™**: æ¨æ¸¬ã®ç¯„å›²ã‚’è¨­å®šã—ã€ã‚²ãƒ¼ãƒ ã®æ§‹é€ ã‚’æ±ºå®šã—ã€é›£æ˜“åº¦ã‚’èª¿æ•´ã—ã¾ã™ã€‚

ãã‚Œã§ã¯ã€æ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ ã‚’å®Ÿè£…ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå§‹ã‚ã¾ã—ã‚‡ã†ã€‚

.. note::

  IRå—ä¿¡æ©Ÿã¨I2C LCD1602ã«ä¸æ…£ã‚Œãªå ´åˆã¯ã€ä»¥ä¸‹ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€šã˜ã¦ãã®åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ã‚’å­¦ã‚“ã§ãã ã•ã„ï¼š

  * :ref:`ar_ir_receiver`
  * :ref:`ar_i2c_lcd1602`

  ã“ã“ã§ã¯ ``LiquidCrystal I2C`` ãŠã‚ˆã³ ``IRremote`` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ **Library Manager** ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚

1. ä»¥å‰ã«ä¿å­˜ã—ãŸã‚¹ã‚±ãƒƒãƒ ``Lesson22_Decode_Key_Value`` ã‚’é–‹ãã¾ã™ã€‚ ``File`` ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ ``Lesson31_Guess_Number`` ã«å¤‰æ›´ã—ã¦ã€Œä¿å­˜ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

.. code-block:: Arduino

  #include <IRremote.h>  // Include the IRremote library

  const int receiverPin = 2;  // Define the pin number for the IR Sensor

  void setup() {
    // Start serial communication at a baud rate of 9600
    Serial.begin(9600);
    // Initialize the IR receiver on the specified pin with LED feedback enabled
    IrReceiver.begin(receiverPin, ENABLE_LED_FEEDBACK);
  }

  void loop() {
    if (IrReceiver.decode()) {  // Check if the IR receiver has received a signal
      bool result = 0;
      String key = decodeKeyValue(IrReceiver.decodedIRData.command);
      if (key != "ERROR") {
        Serial.println(key);  // Print the readable command
        delay(100);
      }
    IrReceiver.resume();  // Enable receiving of the next value
    }
  }

  // Function to map received IR signals to corresponding keys
  String decodeKeyValue(long result) {
    switch (result) {
      case 0x45: return "POWER";
      case 0x47: return "MUTE";
      case 0x46: return "MODE";
      case 0x44: return "PLAY/PAUSE";
      case 0x40: return "BACKWARD";
      case 0x43: return "FORWARD";
      case 0x7: return "EQ";
      case 0x15: return "-";
      case 0x9: return "+";
      case 0x19: return "CYCLE";
      case 0xD: return "U/SD";
      case 0x16: return "0";
      case 0xC: return "1";
      case 0x18: return "2";
      case 0x5E: return "3";
      case 0x8: return "4";
      case 0x1C: return "5";
      case 0x5A: return "6";
      case 0x42: return "7";
      case 0x52: return "8";
      case 0x4A: return "9";
      case 0x0: return "ERROR";
      default: return "ERROR";
    }
  }

2. å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã—ã€LCDã‚’æ­£ã—ã„I2Cã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã‚µã‚¤ã‚ºã§åˆæœŸåŒ–ã—ã¾ã™ã€‚

.. code-block:: Arduino
  :emphasize-lines: 2,3,5

  #include <IRremote.h>           // Include the IR remote control library
  #include <Wire.h>               // Include the Wire library for I2C communication
  #include <LiquidCrystal_I2C.h>  // Include the LCD library for I2C

  LiquidCrystal_I2C lcd(0x27, 16, 2);  // Set up the LCD (address 0x27, 16 columns, 2 rows)

  const int receiverPin = 2;  // IR sensor pin

3. æ¬¡ã«ã€å…¥åŠ›ã•ã‚ŒãŸæ•°å­—ã€ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚ŒãŸã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã€æ¨æ¸¬ç¯„å›²ã®ä¸Šé™ï¼ˆ99ï¼‰ã€ãŠã‚ˆã³ä¸‹é™ï¼ˆ0ï¼‰ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®4ã¤ã®å¤‰æ•°ã‚’ä½œæˆã—ã¾ã™ã€‚

.. code-block:: Arduino
  :emphasize-lines: 9-12

  #include <IRremote.h>           // Include the IR remote control library
  #include <Wire.h>               // Include the Wire library for I2C communication
  #include <LiquidCrystal_I2C.h>  // Include the LCD library for I2C

  LiquidCrystal_I2C lcd(0x27, 16, 2);  // Set up the LCD (address 0x27, 16 columns, 2 rows)

  const int receiverPin = 2;  // IR sensor pin

  int guessedNumber = 0;  // Number input by the user
  int targetNumber = 0;   // Randomly generated target number
  int upper = 99;         // Upper bound of guessing range
  int lower = 0;          // Lower bound of guessing range

4. ``setup()`` é–¢æ•°å†…ã§ã€LCDã‚’åˆæœŸåŒ–ã—ã€æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

.. code-block:: Arduino
  :emphasize-lines: 4-6

  void setup() {
    Serial.begin(9600);                                  // Initialize serial communication at 9600 bps
    IrReceiver.begin(receiverPin, ENABLE_LED_FEEDBACK);  // Initialize IR receiver with LED feedback
    lcd.init();                                          // Initialize the LCD
    lcd.backlight();                                     // Turn on the backlight
    NewTargetNumber();                                   // Initialize game values
  }

5. ``loop()`` é–¢æ•°å†…ã§ã€æœ€åˆã«booleanå‹å¤‰æ•° ``result`` ã‚’ä½œæˆã—ã€ã€Œãƒ‘ãƒ¯ãƒ¼ã€ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚æŠ¼ã•ã‚ŒãŸå ´åˆã¯ã€æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã« ``NewTargetNumber()`` ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

.. code-block:: Arduino
  :emphasize-lines: 9, 12-14

  void loop() {
    if (IrReceiver.decode()) {           // Check if an IR message has been received
      String key = decodeKeyValue(IrReceiver.decodedIRData.command);
      if (key != "ERROR") {
        Serial.println(key);  // Print the readable command
        delay(100);
      }

      bool result = false;

      // Check the key received and act accordingly
      if (key == "POWER") {
        NewTargetNumber();  // Reset game values
      }
    IrReceiver.resume();  // Enable receiving of the next value
    }
  }

6. 0ã‹ã‚‰9ã¾ã§ã®æ•°å­—ã‚’æŠ¼ã—ãŸå ´åˆã€å…¥åŠ›ã•ã‚ŒãŸæ•°å­—ã‚’å¤‰æ•° ``guessedNumber`` ã«æ ¼ç´ã—ã¾ã™ã€‚

* è“„ç©ã•ã‚ŒãŸæ•°å­—ãŒ10ä»¥ä¸Šã®å ´åˆã€ ``checkGuess()`` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã€æ¨æ¸¬ã—ãŸæ•°å­—ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã¨ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚çµæœï¼ˆtrueã¾ãŸã¯falseï¼‰ã¯ ``result`` å¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚
* 1æ¡ã®æ•°å­—ãŒå…¥åŠ›ã•ã‚ŒãŸå ´åˆã€ ``displayResult()`` é–¢æ•°ã‚’ç›´æ¥å‘¼ã³å‡ºã—ã¦ã€LCDã«è¡¨ç¤ºã—ã¾ã™ã€‚
* ``guessedNumber = guessedNumber * 10 + key.toInt();``: ã“ã®è¡Œã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸæ¡ã‚’è“„ç©ã—ã¦å®Œå…¨ãªæ•°å­—ã‚’å½¢æˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ãŸã¨ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ '3' ã‚’æŠ¼ã—ã€ãã®å¾Œ '5' ã‚’æŠ¼ã™ã¨ã€guessedNumber ã¯æœ€åˆã¯3ã§ã€æ¬¡ã«35ã«ãªã‚Šã¾ã™ã€‚ ``key.toInt()`` ã¯æ•°å­—ã®æ–‡å­—åˆ—è¡¨ç¾ã‚’æ•´æ•°ã«å¤‰æ›ã—ã¾ã™ã€‚

.. code-block:: Arduino
  :emphasize-lines: 4-11

  // Check the key received and act accordingly
  if (key == "POWER") {
    NewTargetNumber();  // Reset game values
  } else if (key >= "0" && key <= "9") {
    guessedNumber = guessedNumber * 10;
    guessedNumber += key.toInt();  // Accumulate digits typed
    if (guessedNumber >= 10) {
      result = checkGuess();  // Check if guessed number is correct
    }
    displayResult(result);  // Display input and result on LCD
  }

7. ã€ŒCYCLEã€ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸå ´åˆã€ ``checkGuess()`` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã€å…¥åŠ›ã•ã‚ŒãŸæ¨æ¸¬ãƒŠãƒ³ãƒãƒ¼ãŒæ­£ã—ã„ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚æ­£ã—ã‘ã‚Œã° ``true`` ã‚’è¿”ã—ã€æ­£ã—ããªã‘ã‚Œã° ``false`` ã‚’è¿”ã—ã€ãã®çµæœã‚’ ``result`` å¤‰æ•°ã«æ ¼ç´ã—ã¾ã™ã€‚ãã®å¾Œã€ ``displayResult()`` é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã€LCDã«æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

.. note::

  å‰è¿°ã® ``else if`` æ–‡ã§ã¯ã€10ä»¥ä¸Šã®æ•°å­—ã®ã¿ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã¨æ¯”è¼ƒã•ã‚Œã¾ã™ã€‚10æœªæº€ã®æ•°å­—ã¯LCDã«è¡¨ç¤ºã•ã‚Œã‚‹ã ã‘ã§ã™ã€‚

  ãã®ãŸã‚ã€ã“ã“ã§ã€ŒCYCLEã€ã‚­ãƒ¼ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚1æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã™ã‚‹å ´åˆã€æ•°å­—ã‚’å…¥åŠ›ã—ãŸå¾Œã«ã€ŒCYCLEã€ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã¨æ¯”è¼ƒã§ãã¾ã™ã€‚

.. code-block:: Arduino
  :emphasize-lines: 8-11

      } else if (key >= "0" && key <= "9") {
        guessedNumber = guessedNumber * 10;
        guessedNumber += key.toInt();  // Accumulate digits typed
        if (guessedNumber >= 10) {
          result = checkGuess();  // Check if guessed number is correct
        }
        displayResult(result);  // Display input and result on LCD
      } else if (key == "CYCLE") {
        result = checkGuess();  // Check if guessed number is correct
        displayResult(result);  // Display result on LCD
      }
      IrReceiver.resume();  // Enable receiving of the next value
    }
  }

8. ``NewTargetNumber()`` é–¢æ•°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¨æ¸¬ã™ã‚‹ãŸã‚ã®æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã€ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

* æ¨æ¸¬ç¯„å›²ã® ``upper`` ãŠã‚ˆã³ ``lower`` ã®é™ç•Œã‚’åˆæœŸå€¤ã«è¨­å®šã—ã€LCDç”»é¢ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨æŒ‡ç¤ºã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
* ã¾ãŸã€æ¨æ¸¬ã•ã‚ŒãŸæ•°å­—ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€ãƒ‡ãƒãƒƒã‚°ç›®çš„ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚’ã‚·ãƒªã‚¢ãƒ«ãƒ¢ãƒ‹ã‚¿ãƒ¼ã«å‡ºåŠ›ã—ã¾ã™ã€‚

.. code-block:: Arduino

  void NewTargetNumber() {
    randomSeed(analogRead(A0));    // Seed the random number generator
    targetNumber = random(99);     // Generate a new target number
    upper = 99;                    // Reset upper limit
    lower = 0;                     // Reset lower limit
    lcd.clear();                   // Clear the LCD
    lcd.print("    Welcome!");     // Welcome message
    lcd.setCursor(0, 1);           // Move cursor to the second line
    lcd.print("  Guess Number!");  // Instruction message
    guessedNumber = 0;             // Reset guessed number
    Serial.print("point is ");
    Serial.println(targetNumber);  // Print the target number in serial monitor for debugging
  }

9. ``checkGuess()`` é–¢æ•°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¨æ¸¬ã—ãŸæ•°å­—ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã¨æ¯”è¼ƒã—ã¾ã™ã€‚

* æ¨æ¸¬ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚ˆã‚Šé«˜ã„å ´åˆã€ä¸Šé™ã‚’æ›´æ–°ã—ã¾ã™ã€‚ 
* æ¨æ¸¬ãŒä½ã„å ´åˆã€ä¸‹é™ã‚’æ›´æ–°ã—ã¾ã™ã€‚ 
* æ¨æ¸¬ãŒæ­£ã—ã„å ´åˆã€æ¨æ¸¬ã•ã‚ŒãŸæ•°å­—ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€ ``true`` ã‚’è¿”ã—ã¾ã™ã€‚ 
* ãã‚Œä»¥å¤–ã®å ´åˆã€æ¨æ¸¬ã•ã‚ŒãŸæ•°å­—ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€ ``false`` ã‚’è¿”ã—ã¾ã™ã€‚

.. code-block:: Arduino

  bool checkGuess() {
    if (guessedNumber > targetNumber) {
      if (guessedNumber < upper) upper = guessedNumber;  // Update upper limit
    } else if (guessedNumber < targetNumber) {
      if (guessedNumber > lower) lower = guessedNumber;  // Update lower limit
    } else if (guessedNumber == targetNumber) {
      guessedNumber = 0;
      return true;  // Correct guess
    }
    guessedNumber = 0;
    return false;  // Incorrect guess
  }

10. ``displayResult()`` é–¢æ•°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨æ¸¬ãŒæ­£ã—ã„ã‹ã©ã†ã‹ã«åŸºã¥ã„ã¦LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‚’æ›´æ–°ã—ã¾ã™ã€‚

* æ¨æ¸¬ãŒæ­£ã—ã„å ´åˆã€æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€5ç§’é–“ä¸€æ™‚åœæ­¢ã—ã¦ã‹ã‚‰æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚’ç”Ÿæˆã—ã€ã‚²ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚ 
* æ¨æ¸¬ãŒä¸æ­£è§£ã®å ´åˆã€ç¾åœ¨ã®æ¨æ¸¬ãƒŠãƒ³ãƒãƒ¼ã¨æ›´æ–°ã•ã‚ŒãŸæ¨æ¸¬ç¯„å›²ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

.. code-block:: Arduino

  void displayResult(bool result) {
    lcd.clear();  // Clear the LCD
    if (result) {
      lcd.setCursor(0, 1);
      lcd.print(" You've got it! ");  // Display success message
      delay(5000);                    // Pause before resetting
      NewTargetNumber();              // Reset game values
    } else {
      lcd.print("Enter number:");
      lcd.print(guessedNumber);  // Display the current guess
      lcd.setCursor(0, 1);
      lcd.print(lower);
      lcd.print(" < Point < ");
      lcd.print(upper);  // Display the current range
    }
  }

11. å®Œå…¨ãªã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚ã“ã‚Œã‚’Arduinoãƒœãƒ¼ãƒ‰ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

.. code-block:: Arduino

  #include <IRremote.h>           // Include the IR remote control library
  #include <Wire.h>               // Include the Wire library for I2C communication
  #include <LiquidCrystal_I2C.h>  // Include the LCD library for I2C

  LiquidCrystal_I2C lcd(0x27, 16, 2);  // Set up the LCD (address 0x27, 16 columns, 2 rows)

  const int receiverPin = 2;  // IR sensor pin

  int guessedNumber = 0;  // Number input by the user
  int targetNumber = 0;   // Randomly generated target number
  int upper = 99;         // Upper bound of guessing range
  int lower = 0;          // Lower bound of guessing range

  void setup() {
    Serial.begin(9600);                                  // Initialize serial communication at 9600 bps
    IrReceiver.begin(receiverPin, ENABLE_LED_FEEDBACK);  // Initialize IR receiver with LED feedback
    lcd.init();                                          // Initialize the LCD
    lcd.backlight();                                     // Turn on the backlight
    NewTargetNumber();                                   // Initialize game values
  }

  void loop() {
    if (IrReceiver.decode()) {  // Check if the IR receiver has received a signal
      String key = decodeKeyValue(IrReceiver.decodedIRData.command);
      if (key != "ERROR") {
        Serial.println(key);  // Print the readable command
        delay(100);
      }

      bool result = false;

      // Check the key received and act accordingly
      if (key == "POWER") {
        NewTargetNumber();  // Reset game values
      } else if (key >= "0" && key <= "9") {
        guessedNumber = guessedNumber * 10;
        guessedNumber += key.toInt();  // Accumulate digits typed
        if (guessedNumber >= 10) {
          result = checkGuess();  // Check if guessed number is correct
        }
        displayResult(result);  // Display input and result on LCD
      } else if (key == "CYCLE") {
        result = checkGuess();  // Check if guessed number is correct
        displayResult(result);  // Display result on LCD
      }
      IrReceiver.resume();  // Enable receiving of the next value
    }
  }

  void NewTargetNumber() {
    randomSeed(analogRead(A0));    // Seed the random number generator
    targetNumber = random(99);     // Generate a new target number
    upper = 99;                    // Reset upper limit
    lower = 0;                     // Reset lower limit
    lcd.clear();                   // Clear the LCD
    lcd.print("    Welcome!");     // Welcome message
    lcd.setCursor(0, 1);           // Move cursor to the second line
    lcd.print("  Guess Number!");  // Instruction message
    guessedNumber = 0;             // Reset guessed number
    Serial.print("point is ");
    Serial.println(targetNumber);  // Print the target number in serial monitor for debugging
  }

  bool checkGuess() {
    if (guessedNumber > targetNumber) {
      if (guessedNumber < upper) upper = guessedNumber;  // Update upper limit
    } else if (guessedNumber < targetNumber) {
      if (guessedNumber > lower) lower = guessedNumber;  // Update lower limit
    } else if (guessedNumber == targetNumber) {
      guessedNumber = 0;
      return true;  // Correct guess
    }
    guessedNumber = 0;
    return false;  // Incorrect guess
  }

  void displayResult(bool result) {
    lcd.clear();  // Clear the LCD
    if (result) {
      lcd.setCursor(0, 1);
      lcd.print(" You've got it! ");  // Display success message
      delay(5000);                    // Pause before resetting
      NewTargetNumber();              // Reset game values
    } else {
      lcd.print("Enter number:");
      lcd.print(guessedNumber);  // Display the current guess
      lcd.setCursor(0, 1);
      lcd.print(lower);
      lcd.print(" < Point < ");
      lcd.print(upper);  // Display the current range
    }
  }

  // Function to map received IR signals to corresponding keys
  String decodeKeyValue(long result) {
    switch (result) {
      case 0x45: return "POWER";
      case 0x47: return "MUTE";
      case 0x46: return "MODE";
      case 0x44: return "PLAY/PAUSE";
      case 0x40: return "BACKWARD";
      case 0x43: return "FORWARD";
      case 0x7: return "EQ";
      case 0x15: return "-";
      case 0x9: return "+";
      case 0x19: return "CYCLE";
      case 0xD: return "U/SD";
      case 0x16: return "0";
      case 0xC: return "1";
      case 0x18: return "2";
      case 0x5E: return "3";
      case 0x8: return "4";
      case 0x1C: return "5";
      case 0x5A: return "6";
      case 0x42: return "7";
      case 0x52: return "8";
      case 0x4A: return "9";
      case 0x0: return "ERROR";
      default: return "ERROR";
    }
  }

12. ã“ã‚Œã§ã€ä»»æ„ã®æ•°å­—ã‚­ãƒ¼ã‚’æŠ¼ã—ã€è¡¨ç¤ºã•ã‚ŒãŸæ•°å­—ç¯„å›²ã«å¾“ã£ã¦æ•°å­—ã‚’å…¥åŠ›ã§ãã¾ã™ã€‚

* 2æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ãŸå ´åˆã€2æ¡ç›®ã‚’å…¥åŠ›å¾Œã€ç›´æ¥ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã¨æ¯”è¼ƒã—ã¾ã™ã€‚
* 1æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ãŸå ´åˆã€ã€ŒCYCLEã€ã‚­ãƒ¼ã‚’å†åº¦æŠ¼ã—ã¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã¨æ¯”è¼ƒã‚’é–‹å§‹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* æ¨æ¸¬ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ã‚ˆã‚Šé«˜ã„å ´åˆã€ä¸Šé™ãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚
* æ¨æ¸¬ãŒä½ã„å ´åˆã€ä¸‹é™ãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚
* æ¨æ¸¬ãŒæ­£ã—ã„å ´åˆã€LCDã«æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã€5ç§’é–“ä¸€æ™‚åœæ­¢ã—ãŸå¾Œã€æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒŠãƒ³ãƒãƒ¼ãŒç”Ÿæˆã•ã‚Œã€ã‚²ãƒ¼ãƒ ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚

.. raw:: html

    <video muted controls style = "max-width:90%">
        <source src="_static/video/31_guess_number.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

13. æœ€å¾Œã«ã€ã‚³ãƒ¼ãƒ‰ã‚’ä¿å­˜ã—ã€ä½œæ¥­ã‚¹ãƒšãƒ¼ã‚¹ã‚’æ•´ç†ã™ã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚

**Question**

ã‚²ãƒ¼ãƒ ã®æ¥½ã—ã•ã‚’é«˜ã‚ã‚‹ãŸã‚ã«è¿½åŠ ã§ãã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä½•ã§ã™ã‹ï¼Ÿ ãã‚Œã‚‰ã¯ã‚²ãƒ¼ãƒ ã§ã©ã®ã‚ˆã†ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã‹ï¼Ÿ

**Summary**

æœ¬æ—¥ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€Arduinoãƒœãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒŠãƒ³ãƒãƒ¼æ¨æ¸¬ã‚²ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã—ã€IRå—ä¿¡æ©Ÿã‚„LCDãªã©ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ±åˆã—ã¦ã€ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãªã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚ãƒ©ãƒ³ãƒ€ãƒ ãƒŠãƒ³ãƒãƒ¼ã®ç”Ÿæˆã€å…¥åŠ›å‡¦ç†ã€æ¡ä»¶åˆ†å²ã¨ã„ã£ãŸã•ã¾ã–ã¾ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ¦‚å¿µã‚’æ¢æ±‚ã—ã¾ã—ãŸã€‚
